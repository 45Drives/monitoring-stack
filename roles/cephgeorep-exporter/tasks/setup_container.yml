---
- name: set fact container_binary to docker centos 7
  set_fact: 
    container_binary: "docker"
  when:
    - ansible_distribution == 'CentOS'
    - ansible_distribution_major_version == '7'

- name: set fact container_binary to docker debian
  set_fact: 
    container_binary: "docker"
  when:
    - ansible_distribution == 'Debian'

- name: ship systemd service
  template:
    src: cephgeorep_exporter.service.j2
    dest: "/etc/systemd/system/cephgeorep_exporter.service"
    owner: root
    group: root
    mode: 0644

- name: create run path to mirror to container
  ansible.builtin.file:
    path: /run/cephgeorep
    state: directory
    mode: '0755'

- name: start the cephgeorep_exporter service
  systemd:
    name: cephgeorep_exporter
    state: started
    enabled: yes
    daemon_reload: yes
  failed_when: false
